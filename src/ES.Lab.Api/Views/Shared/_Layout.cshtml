<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
    @Styles.Render("~/Content/css")
    @Styles.Render("~/bundles/toastr")
    @Scripts.Render("~/bundles/modernizr")
</head>
<body>
    <header>
        <div class="content-wrapper">
            <div class="float-left">
                <p class="site-title">
                    <a href="~/">ASP.NET Web API</a></p>
            </div>
            <div class="float-right">
                <nav>
                    <ul id="menu">
                        <li>@Html.ActionLink("Home", "Index", "Home", new { area = "" }, null)</li>
                        <li>@Html.ActionLink("API", "Index", "Help", new { area = "" }, null)</li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>
    @RenderBody()
    
    <button id="createGame" title="CreateGame">CreateGame</button>

    @Scripts.Render("~/bundles/jquery")
    @RenderSection("scripts", required: false)
    <script src="/Scripts/toastr.min.js" type="text/javascript"></script>
    <script src="/Scripts/jquery.signalR-1.0.1.min.js" type="text/javascript"></script>
    <script src="~/signalr/hubs" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {

            //Toastr config
            toastr.options = { positionClass: 'toast-bottom-right' };

            // Proxy created on the fly          
            var bhub = $.connection.broadcastHub;

            // Declare a function on the chat hub so the server can invoke it          
            bhub.client.something = function (e) {
                toastr.info(e.Title);
            };

            // Start the connection
            $.connection.hub.start().done(function () {
                var clientId = $.connection.hub.id;
                $('#createGame').click(function() {
                    $.ajax({
                        type: 'POST',
                        url: '/api/game',
                        data: { "name": "webgame1", "firstTo": "3", "clientId": clientId },
                        dataType: 'json',
                        success: function (data) {
                            console.log(data.username);
                        },
                    });
                });
            });
        });
</script>
</body>
</html>
